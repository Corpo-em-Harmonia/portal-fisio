<div class="dashboard-container">
  <!-- Top Navigation -->
  <div class="top-nav">
    <button class="nav-btn nav-btn-active">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect width="7" height="9" x="3" y="3" rx="1"/>
        <rect width="7" height="5" x="14" y="3" rx="1"/>
        <rect width="7" height="9" x="14" y="12" rx="1"/>
        <rect width="7" height="5" x="3" y="16" rx="1"/>
      </svg>
      Dashboard
    </button>
    <button class="nav-btn" (click)="navigateToLeads()">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
        <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
      </svg>
      Leads / Avaliações
    </button>
  </div>

  <!-- Header -->
  <div class="header-card">
    <div class="header-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
      </svg>
    </div>
    <div>
      <h1 class="header-title">Painel Administrativo</h1>
      <p class="header-subtitle">Gerencie seus agendamentos e pacientes</p>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card stat-purple">
      <p class="stat-label">Pacientes Ativos</p>
      <p class="stat-value">{{ stats.totalPacientes }}</p>
      <div class="stat-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
          <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
        </svg>
      </div>
    </div>

    <div class="stat-card stat-blue">
      <p class="stat-label">Sessões Hoje</p>
      <p class="stat-value">{{ stats.sessoesHoje }}</p>
      <div class="stat-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
          <line x1="16" x2="16" y1="2" y2="6"/>
          <line x1="8" x2="8" y1="2" y2="6"/>
          <line x1="3" x2="21" y1="10" y2="10"/>
        </svg>
      </div>
    </div>

    <div class="stat-card stat-green">
      <p class="stat-label">Sessões na Semana</p>
      <p class="stat-value">{{ stats.sessoesSemana }}</p>
      <div class="stat-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"/>
          <polyline points="12 6 12 12 16 14"/>
        </svg>
      </div>
    </div>

    <div class="stat-card stat-orange">
      <p class="stat-label">Taxa de Presença</p>
      <p class="stat-value">{{ stats.taxaPresenca }}%</p>
      <div class="stat-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/>
          <polyline points="16 7 22 7 22 13"/>
        </svg>
      </div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="main-grid">
    <!-- Calendar Section -->
    <div class="calendar-section">
      <div class="section-header">
        <div class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
            <line x1="16" x2="16" y1="2" y2="6"/>
            <line x1="8" x2="8" y1="2" y2="6"/>
            <line x1="3" x2="21" y1="10" y2="10"/>
          </svg>
          Agenda Semanal
        </div>
        <button class="btn-novo" (click)="novoAgendamento()">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" x2="12" y1="5" y2="19"/>
            <line x1="5" x2="19" y1="12" y2="12"/>
          </svg>
          Novo Agendamento
        </button>
      </div>

      <div class="calendar-content">
        <!-- Filters -->
        <div class="filters">
          <div class="filter-group">
            <label>Filtrar por Paciente</label>
            <select [(ngModel)]="selectedPaciente" class="filter-select">
              <option value="">Todos os pacientes</option>
              <option *ngFor="let p of pacientes" [value]="p.id">{{ p.nome }}</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Status</label>
            <select [(ngModel)]="filterStatus" class="filter-select">
              <option value="todos">Todos</option>
              <option value="agendado">Agendado</option>
              <option value="confirmado">Confirmado</option>
              <option value="realizado">Realizado</option>
              <option value="cancelado">Cancelado</option>
            </select>
          </div>
        </div>

        <!-- Calendar Navigation -->
        <div class="calendar-nav">
          <button class="nav-arrow" (click)="previousWeek()">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m15 18-6-6 6-6"/>
            </svg>
          </button>
          
          <div class="date-selector">
            <button class="date-selector-btn" (click)="toggleDatePicker()">
              <h3>{{ getMonthYear() }}</h3>
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m6 9 6 6 6-6"/>
              </svg>
            </button>
            
            <div class="date-picker-dropdown" *ngIf="showDatePicker">
              <div class="date-picker-content">
                <div class="date-picker-row">
                  <label>Mês:</label>
                  <select [value]="getCurrentMonth()" (change)="changeMonth(+$any($event.target).value)" class="date-picker-select">
                    <option *ngFor="let month of months" [value]="month.value">{{ month.label }}</option>
                  </select>
                </div>
                <div class="date-picker-row">
                  <label>Ano:</label>
                  <select [value]="getCurrentYear()" (change)="changeYear(+$any($event.target).value)" class="date-picker-select">
                    <option *ngFor="let year of years" [value]="year">{{ year }}</option>
                  </select>
                </div>
                <div class="date-picker-actions">
                  <button class="btn-today" (click)="goToToday(); showDatePicker = false">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
                      <line x1="16" x2="16" y1="2" y2="6"/>
                      <line x1="8" x2="8" y1="2" y2="6"/>
                      <line x1="3" x2="21" y1="10" y2="10"/>
                    </svg>
                    Hoje
                  </button>
                  <button class="btn-close" (click)="showDatePicker = false">Fechar</button>
                </div>
              </div>
            </div>
          </div>
          
          <button class="nav-arrow" (click)="nextWeek()">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m9 18 6-6-6-6"/>
            </svg>
          </button>
        </div>

        <!-- Calendar Grid -->
        <div class="calendar-grid">
          <div *ngFor="let day of [0,1,2,3,4,5,6]; let i = index" class="day-header">
            {{ getDayName(i) }}
          </div>
          
          <div *ngFor="let day of getWeekDays()" class="day-cell" [class.today]="isToday(day)">
            <div class="day-number">{{ day.getDate() }}</div>
            <div class="day-events">
              <div *ngFor="let ag of getAgendamentosForDay(day)" 
                   class="event-item" 
                   [ngClass]="getStatusColor(ag.status)">
                <div class="event-time">{{ ag.horario }}</div>
                <div class="event-name">{{ ag.pacienteNome }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Detailed Appointments -->
        <div class="appointments-detailed">
          <h4>Agendamentos Detalhados</h4>
          <div class="appointments-list">
            <div *ngFor="let ag of filteredAgendamentos" class="appointment-card">
              <div class="appointment-date">
                <div class="date-day">{{ getDay(ag.data) }}</div>
                <div class="date-month">{{ getMonthShort(ag.data) }}</div>
              </div>
              <div class="appointment-info">
                <div class="appointment-name">{{ ag.pacienteNome }}</div>
                <div class="appointment-details">
                  {{ ag.horario }} • {{ ag.duracao }} min • {{ getTipoLabel(ag.tipo) }}
                </div>
              </div>
              <div class="appointment-status" [ngClass]="getStatusColor(ag.status)">
                {{ ag.status }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Patients Sidebar -->
    <div class="patients-section">
      <div class="section-header">
        <div class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
            <path d="M22 21v-2a4 4 0 0 0-3-3.87"/>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
          </svg>
          Pacientes
        </div>
      </div>

      <div class="patients-content">
        <!-- Search -->
        <div class="search-box">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"/>
            <path d="m21 21-4.3-4.3"/>
          </svg>
          <input 
            type="text" 
            placeholder="Buscar paciente..." 
            [(ngModel)]="searchTerm"
          />
        </div>

        <!-- Patients List -->
        <div class="patients-list">
          <div *ngFor="let paciente of filteredPacientes" 
               class="patient-card"
               [class.selected]="selectedPaciente === paciente.id"
               (click)="selectPaciente(paciente.id)">
            <div class="patient-header">
              <div class="patient-name">{{ paciente.nome }}</div>
              <div class="patient-status" [class.active]="paciente.status === 'ativo'"></div>
            </div>
            <div class="patient-info">
              <div class="info-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                  <polyline points="14 2 14 8 20 8"/>
                  <line x1="16" x2="8" y1="13" y2="13"/>
                  <line x1="16" x2="8" y1="17" y2="17"/>
                  <polyline points="10 9 9 9 8 9"/>
                </svg>
                {{ paciente.totalSessoes }} sessões realizadas
              </div>
              <div class="info-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"/>
                  <polyline points="12 6 12 12 16 14"/>
                </svg>
                Próxima: {{ formatDate(paciente.proximaSessao) }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
